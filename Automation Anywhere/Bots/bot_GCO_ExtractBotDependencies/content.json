{"triggers":[],"nodes":[{"uid":"d68cccff-4d65-4840-8483-8a4b92edc979","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c62ad74f-f957-4b48-b3da-594e6571a9c1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------"}}]},{"uid":"3e6271bc-a0c2-4efc-997d-d3605893eb68","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This bot will get all dependencies of a process (Main+subtask) and list them in xls file"}}]},{"uid":"3580b5fc-6855-408e-9001-0c9a35109842","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Bot Description"}}]},{"uid":"53d4afd7-6b75-4d79-99be-05239333b04a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b6e62925-3e5a-415c-a8c8-83c0ae4cc145","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get all dependencies of a main task (need id of main task)"}}]},{"uid":"2ff85a9d-28c9-4677-abb9-e4df7c76e63b","commandName":"StartSession","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"string":"Default","type":"STRING"}}]},{"uid":"823a4309-2b39-4b49-9b86-8dfdfb81a523","commandName":"GetFileDetails","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"id","value":{"type":"STRING","string":"11649"}},{"name":"workspacetype","value":{"type":"STRING","string":"SELECT"}},{"name":"workspaceSelect","value":{"type":"STRING","string":"public"}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"name","value":{"type":"VARIABLE","variableName":"strProcessName"}}]}},{"uid":"cd914fe0-fad4-43fd-9d0b-d49750cd67c8","commandName":"GetDependencies","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"id","value":{"type":"STRING","string":"11649"}}],"returnTo":{"type":"VARIABLE","variableName":"lDependencies"}},{"uid":"fce6d2b0-dfa6-4d4e-bca8-9546011b4d2e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"dependencies: $lDependencies.LegacyAutomation:listToString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b707d142-68e6-44d8-9397-61569fe54913","commandName":"GetBotAgentToken","packageName":"A2019_Control_Room_APIs","disabled":true,"returnTo":{"type":"VARIABLE","variableName":"sToken"}},{"uid":"ba2a88ce-eace-4bc1-be28-4381bcb46364","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Open xls file (change path if needed)"}}]},{"uid":"d4172820-e4f1-4a12-96ce-21a0b775fc6a","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Test/PackageList.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","string":"Dependencies"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"},"sessionTarget":"LOCAL"}},{"uid":"552472b1-a89c-4434-98d3-75aa74f9bdcb","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Test/PackageList.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"session1"},"sessionTarget":"LOCAL"}},{"uid":"81f9fcf8-7738-4e2b-a133-44e8b0cae637","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Loop in all tasks (main+dependencies)"}}]},{"uid":"043cad03-c062-4911-8ee5-a313bb86d10b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"aee2be6c-c520-4dce-861e-7d1e22801699","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonString","value":{"type":"STRING","expression":"$dDependencyJson$"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"b48e8cd4-baf3-456e-a063-3862b9ee77b0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task name"}}]},{"uid":"d93ab236-a997-4a6f-afd2-3fcca732673e","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"name"}}],"returnTo":{"type":"VARIABLE","variableName":"depName"}},{"uid":"3dee2c0c-e669-48be-be25-5ffdae4a2b71","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task id"}}]},{"uid":"7af842f8-8cc3-4d00-8d3e-4c62003c91f0","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"id"}}],"returnTo":{"type":"VARIABLE","variableName":"depId"}},{"uid":"82a2f1de-a9bd-4b76-b11d-0d02c7fc79ce","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task path"}}]},{"uid":"6498ba49-571d-4dd0-b631-c59b65634a13","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"path"}}],"returnTo":{"type":"VARIABLE","variableName":"depPath"}},{"uid":"4e25d1ca-3f63-4090-8308-dc17172ad1df","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task type"}}]},{"uid":"6f544fb6-dac6-491f-b27e-8013afbfb5d6","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"type"}}],"returnTo":{"type":"VARIABLE","variableName":"depType"}},{"uid":"49a136c7-1d37-41c4-aff1-b2e933bdca82","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task details"}}]},{"uid":"94b260f7-e6f5-4849-89bc-7f54134ff648","commandName":"GetFileDetails","packageName":"RepositoryServices","disabled":true,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"id","value":{"type":"STRING","expression":"$depId$"}},{"name":"workspacetype","value":{"type":"STRING","string":"SELECT"}},{"name":"workspaceSelect","value":{"type":"STRING","string":"public"}}],"returnTo":{"type":"VARIABLE","variableName":"dBotDetails"}},{"uid":"ec414993-a5ee-429e-a133-cc5d9056bb28","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dBotDetails{type}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"36f33364-49ce-4cf8-bc37-ea969286f9a2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"filter on taskbots only from dependencies (could be images, other files...)"}}]},{"uid":"fb9a43ad-1057-4f8c-8635-9cbce6d4cdbb","commandName":"toNumber","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$depId$"}}],"returnTo":{"type":"VARIABLE","variableName":"nBotId"}},{"uid":"23579b04-e80a-4587-b508-1e78a5ba71eb","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$depId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"28c8bf50-868c-4f2b-afe5-25db0c2abdf7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get packages list (name and version) for current task"}}]},{"uid":"939aad1e-84cc-4a31-b5cf-c6fefaa3e028","commandName":"GetBotPackages","packageName":"A2019_Control_Room_APIs","disabled":true,"attributes":[{"name":"sessionTypeInput","value":{"type":"STRING","string":"BOT_RUNNER_SESSION"}},{"name":"fileIdInput","value":{"type":"NUMBER","expression":"$nBotId$"}}],"returnTo":{"type":"VARIABLE","variableName":"lPackagesList"}},{"uid":"5bd18624-b079-4773-9fa9-4f6363d5ee82","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Write in xls file"}}]},{"uid":"9a01445d-d192-487e-9219-894e76d31cce","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"A$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$strProcessName$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]},{"uid":"18b37963-1fab-4daa-a34c-1bc96547715e","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"B$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$depName$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]},{"uid":"8481be84-0ce7-4db4-8b33-e54b053b6829","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$depPath$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]},{"uid":"6a076417-7278-41be-bcbb-3c172848cd9c","commandName":"SetCell","packageName":"Excel","disabled":false,"attributes":[{"name":"setCellType","value":{"type":"STRING","string":"CELL"}},{"name":"cell","value":{"type":"STRING","expression":"D$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$depType$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]},{"uid":"fc9ae451-23d2-4b98-a7fa-e5aebfefd2fc","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$Counter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"Counter"}},{"uid":"d68e558d-722e-43d7-b3ad-5833eb98ec9e","commandName":"loop.commands.start","packageName":"Loop","disabled":true,"children":[],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dCurrentPackage"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lPackagesList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"0bffe8d8-31e3-4a16-abbb-7ea9c1a9307a","commandName":"put","packageName":"Dictionary","disabled":true,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dBotPackages"}},{"name":"key","value":{"type":"STRING","string":"id"}},{"name":"varOrManual","value":{"type":"STRING","string":"Variable"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"depId"}}]},{"uid":"16e00662-7ef2-4213-984b-af00c37ac52f","commandName":"put","packageName":"Dictionary","disabled":true,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dBotPackages"}},{"name":"key","value":{"type":"STRING","string":"name"}},{"name":"varOrManual","value":{"type":"STRING","string":"Variable"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"depName"}}]},{"uid":"cf804027-51cf-4c2d-977e-49eeb8ee1ab9","commandName":"addItem","packageName":"List","disabled":true,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lDendanciesIDs"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"depId"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"22decafa-6930-48d5-a619-50ac7ed2cf09","commandName":"if","packageName":"If","disabled":true,"children":[{"uid":"f8eeb1b2-379e-4f9e-849f-a0b4913d4e91","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"dependencies ID: $depId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dBotDetails{type}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"application/vnd.aa.taskbot"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dDependencyJson"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lDependencies"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get all bot id"}}]},{"uid":"cfbe87c1-73cd-4ee1-b3ce-8be0a444a9b0","commandName":"SaveSpreadSheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]},{"uid":"6ff74066-2fa7-4eab-9b96-a9deb858f42b","commandName":"CloseSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"dep"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sToken","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"lPackagesList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"dCurrentPackage","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"Counter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"2"}},{"name":"lDependencies","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"DICTIONARY","defaultValue":{"type":"LIST","list":[]}},{"name":"dDependencyJson","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"depId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"lDendanciesIDs","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"LIST","list":[]}},{"name":"depName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dBotPackages","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"nBotId","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dBotDetails","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"depPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"depType","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strProcessName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["22decafa-6930-48d5-a619-50ac7ed2cf09","cd914fe0-fad4-43fd-9d0b-d49750cd67c8"],"packages":[{"name":"A2019_Control_Room_APIs","version":"1.24.1-20211206-090004"},{"name":"Comment","version":"2.10.0-20220118-153626"},{"name":"Dictionary","version":"3.4.0-20211011-141701"},{"name":"Dictionary","version":"3.4.0-20211011-141701"},{"name":"Excel","version":"2.13.0-20220120-063927"},{"name":"Excel_MS","version":"6.3.0-20211028-055115"},{"name":"Excel_MS","version":"6.3.0-20211028-055115"},{"name":"If","version":"3.4.0-20220127-062702"},{"name":"JSONHandler","version":"1.0.9-20200423-090902"},{"name":"LegacyAutomation","version":"4.7.0-20211020-020823"},{"name":"LegacyAutomation","version":"4.7.0-20211020-020823"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"Loop","version":"3.1.0-20211011-141812"},{"name":"Loop","version":"3.1.0-20211011-141812"},{"name":"MessageBox","version":"3.1.0-20211011-141813"},{"name":"MessageBox","version":"3.1.0-20211011-141813"},{"name":"Number","version":"3.2.0-20211011-141826"},{"name":"Number","version":"3.2.0-20211011-141826"},{"name":"RepositoryServices","version":"2.1.0-20211217-173811"},{"name":"Step","version":"2.1.0-20211016-070304"},{"name":"Step","version":"2.1.0-20211016-070304"},{"name":"String","version":"5.0.0-20211011-142159"},{"name":"String","version":"5.0.0-20211011-142159"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}