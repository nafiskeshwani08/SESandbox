{"triggers":[],"nodes":[{"uid":"baa77843-a041-4766-8d1b-d787b8c8ecfa","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fe5a72ad-01b8-435e-affe-8676ffaa55a2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0db589de-78a0-4182-a41d-ae7d6a1272d8","commandName":"startGoogleDocumentAISession","packageName":"GoogleDocumentAI","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"DocumentAI"}},{"name":"jsonPath","value":{"type":"FILE","string":"file:///C:/Users/Gregorie%20Aubertin/OneDrive%20-%20Automation%20Anywhere/Int%C3%A9grations/GCP/Access/gregoire-aubertin-sa%40gcp-serviceaccounts-keys.iam.gserviceaccount.com.json"}},{"name":"projectID","value":{"type":"STRING","string":"gcp-aaisalesengineers"}},{"name":"location","value":{"type":"STRING","string":"us"}}]},{"uid":"f65b71e8-5b44-4ec7-8831-c69c19f01263","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","string":"Files not processed"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Start AI Session"}}]},{"uid":"b950b39c-fd41-4cdb-b601-0988d1651c59","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"6553064e-feb1-4a4c-93d7-3772695a2394","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"80703674-d301-4d57-bdf7-9a070384597d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0a6a5350-1611-4ca1-9a2f-9189e79fc3f9","commandName":"SyncGoogleFormParserSync","packageName":"GoogleDocumentAI","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"DocumentAI"}},{"name":"file","value":{"type":"FILE","expression":"file://$sInputFolder$/$FileName$.$extension$"}},{"name":"outputPath","value":{"type":"STRING","expression":"$AnnotedFolder$"}},{"name":"parserID","value":{"type":"STRING","string":"fc8a34490c119078"}},{"name":"includeheader","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"results"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Extract"}}]},{"uid":"f0671c05-8c2d-4106-8761-37c3df54b3bd","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"BP"}}]},{"uid":"ab742a00-4e23-467c-82af-53d06763f1d6","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"results"}},{"name":"key","value":{"type":"STRING","string":"entities"}}],"returnTo":{"type":"VARIABLE","variableName":"sEntities"}},{"uid":"83fd3d7d-9b06-4e53-b773-03462dd66903","commandName":"jsontodict","packageName":"JSONParser","disabled":false,"attributes":[{"name":"jsonstring","value":{"type":"STRING","expression":"$sEntities$"}}],"returnTo":{"type":"VARIABLE","variableName":"dEntities"}},{"uid":"7e3488d7-dc07-402b-965e-18fe05844781","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"bcfaa02f-9348-447a-9d23-b392d54f1ec9","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"76cbcfcd-fe47-4b5e-be0b-28f2996d50d6","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tEntities"}},{"name":"rowPosition","value":{"type":"NUMBER","number":"0"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","expression":"$aKeyName$"}},{"name":"value","value":{"type":"STRING","expression":"$dEntities{$aKeyName$}$"}}]}],"branches":[]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"aKeyName"},"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dEntities"}}],"value":{"type":"ITERATOR","iteratorName":"dictionary.iterators.keys","packageName":"Dictionary"}}]},{"uid":"6853e18c-69cc-4c7a-a9bc-6378bfc166a7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Case of tax rate"}}]},{"uid":"3c146def-25b2-47dd-8fe0-10c7b95135ef","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6bdbea40-e8f4-4016-91b8-1929b8526e84","commandName":"assign","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"LIST","expression":"$dEntities{vat}$"}}],"returnTo":{"type":"VARIABLE","variableName":"lVAT"}},{"uid":"ff4187d6-4210-415d-b258-8ad6cb842f5f","commandName":"assign","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceDictionary","value":{"type":"DICTIONARY","expression":"$lVAT[0]$"}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"tax_rate","value":{"type":"VARIABLE","variableName":"stax_rate"}}]}},{"uid":"1e09e98d-db75-40cc-9f0d-5e4a1eb2aedd","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tEntities"}},{"name":"rowPosition","value":{"type":"NUMBER","number":"0"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","string":"tax_rate"}},{"name":"value","value":{"type":"STRING","expression":"$stax_rate$"}}]}],"branches":[]},{"uid":"d0eadc7f-fc43-48df-8ada-443528a9ca1b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"339852e1-25f2-4439-b91e-92b46470782c","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"bValidExtraction"}},{"uid":"0dfaf396-3172-4e84-a0e1-3859e077f3b4","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"0d691b46-5ce9-458b-83d1-7814db16e815","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a6e15b48-3084-43f3-aa46-ccc730409aca","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"bValidExtraction"}},{"uid":"0bb24764-833e-4e7b-949a-8ae8682ae5b2","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$tEntities[0]{$sField$}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"sField"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lMandatoryFields"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Validation rules"}}]},{"uid":"8f08351c-eeac-4c3a-a3e4-3d6a3145efd6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3499d7a4-fa70-4bdc-a793-2782bd01165e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"64267e25-c910-4ddc-9563-8438889cce3a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Valid"}}],"returnTo":{"type":"VARIABLE","variableName":"sExtractionCategory"}}],"branches":[{"uid":"83c8680a-463e-44f0-9822-f8977f9a7889","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"162ff74a-4e19-40e1-aa8b-744eb3f9518c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"To validate"}}],"returnTo":{"type":"VARIABLE","variableName":"sExtractionCategory"}},{"uid":"a892e2c6-f96f-496a-84cb-91a0b346c991","commandName":"CreateRequest","packageName":"Process","disabled":false,"attributes":[{"name":"repositoryUri","value":{"type":"STRING","string":"repository:///Automation%20Anywhere/Bots/Sales%20Engineering/Gregoire.Aubertin/Demo/Saint%20Gobain/AutoExtract%20WS/Processes/Validation"}},{"name":"inputDictionary","value":{"type":"DICTIONARY","dictionary":[{"key":"TextBox0","value":{"type":"STRING","expression":"$tEntities[0]{\"invoice_id\"}$"}},{"key":"TextBox1","value":{"type":"STRING","expression":"$tEntities[0]{\"invoice_date\"}$"}},{"key":"TextBox2","value":{"type":"STRING","expression":"$tEntities[0]{\"supplier_name\"}$"}},{"key":"TextBox3","value":{"type":"STRING","expression":"$tEntities[0]{\"supplier_tax_id\"}$"}},{"key":"TextBox4","value":{"type":"STRING","expression":"$tEntities[0]{\"receiver_name\"}$"}},{"key":"TextBox5","value":{"type":"STRING","expression":"$tEntities[0]{\"purchase_order\"}$"}},{"key":"TextBox6","value":{"type":"STRING","expression":"$tEntities[0]{\"total_amount\"}$"}},{"key":"TextBox7","value":{"type":"STRING","expression":"$tEntities[0]{\"net_amount\"}$"}},{"key":"TextBox8","value":{"type":"STRING","expression":"$tEntities[0]{\"tax_rate\"}$"}},{"key":"TextBox9","value":{"type":"STRING","expression":"$tEntities[0]{\"total_tax_amount\"}$"}},{"key":"TextBox10","value":{"type":"STRING","expression":"$tEntities[0]{currency}$"}}]}},{"name":"enableFileInput","value":{"type":"BOOLEAN","boolean":true}},{"name":"fileInputDictionary","value":{"type":"DICTIONARY","dictionary":[{"key":"File0","value":{"type":"STRING","expression":"$sInputFolder$/$FileName$.$extension$"}},{"key":"File0-mimetype","value":{"type":"STRING","string":"application/pdf"}}]}}],"returnTo":{"type":"VARIABLE","variableName":"nProcessID"}},{"uid":"e12cba88-ebec-42cf-8ede-8dd2f2a906ad","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ff6be76d-8dfe-430f-987d-7bc8af618b0d","commandName":"AssignTask","packageName":"Process","disabled":false,"attributes":[{"name":"TaskId","value":{"type":"NUMBER","expression":"$nProcessID$"}},{"name":"UserId","value":{"type":"NUMBER","number":"874"}}]}],"branches":[{"uid":"740678a4-b09f-41e9-9ceb-1a360f19af8e","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4a025a45-af4c-46fb-b0e9-1af46e2cfebb","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"prompt-assignment"}}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$bValidExtraction$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Routage"}}]},{"uid":"684ff325-5a36-40dc-ab55-9bc68aebb770","commandName":"writeToFile","packageName":"DataTable","disabled":false,"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"tEntities"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sOutputFolder$/$sExtractionCategory$/$FileName$.csv"}},{"name":"createDirectories","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendToExistingFile","value":{"type":"STRING","string":"overwrite"}},{"name":"rowDelimiter","value":{"type":"STRING","string":"NEW_LINE"}},{"name":"columnDelimiter","value":{"type":"STRING","string":"SEMI_COLON"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]}],"branches":[{"uid":"f44edcfa-f50b-4fea-8830-1947fcf61dc7","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"64208635-5281-4918-badc-8b453018046f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"$FileName$.$extension$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"DICTIONARY","dictionary":[{"key":"name","value":{"type":"VARIABLE","variableName":"FileName"}},{"key":"extension","value":{"type":"VARIABLE","variableName":"extension"}}]},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sInputFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"ec169c2a-7bdd-4f95-aac8-84a6f7f5fe38","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0deeb838-7a57-4389-8183-5f39ce20b6f2","commandName":"endGoogleDocumentAISession","packageName":"GoogleDocumentAI","disabled":false,"attributes":[{"name":"sessionName","value":{"string":"DocumentAI","type":"STRING"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"End Ai Session"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Auto extraction"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"results","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sInputFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Demo\\Saint Gobain Auto extraction\\Input"}},{"name":"FileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"extension","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"AnnotedFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Demo\\AnnotedFolder"}},{"name":"tEntities","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"invoice_id","type":"STRING"},{"name":"invoice_date","type":"STRING"},{"name":"supplier_name","type":"STRING"},{"name":"supplier_tax_id","type":"STRING"},{"name":"receiver_name","type":"STRING"},{"name":"purchase_order","type":"STRING"},{"name":"total_amount","type":"STRING"},{"name":"net_amount","type":"STRING"},{"name":"tax_rate","type":"STRING"},{"name":"total_tax_amount","type":"STRING"},{"name":"currency","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"sEntities","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dEntities","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"aKeyName","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sOutputFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Demo\\Saint Gobain Auto extraction\\Output"}},{"name":"lVAT","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"LIST","list":[]}},{"name":"stax_rate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"lMandatoryFields","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"invoice_id"},{"type":"STRING","string":"invoice_date"},{"type":"STRING","string":"supplier_name"},{"type":"STRING","string":"receiver_name"},{"type":"STRING","string":"total_amount"},{"type":"STRING","string":"net_amount"},{"type":"STRING","string":"tax_rate"},{"type":"STRING","string":"total_tax_amount"},{"type":"STRING","string":"currency"}]}},{"name":"bValidExtraction","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"sField","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sExtractionCategory","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dValidator","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sLogFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"c:\\temp\\SGWS_Files not processed.txt"}},{"name":"nProcessID","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":["6853e18c-69cc-4c7a-a9bc-6378bfc166a7","f0671c05-8c2d-4106-8761-37c3df54b3bd"],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"DataTable","version":"3.0.0-20210722-144817"},{"name":"DataTable","version":"3.0.0-20210722-144817"},{"name":"Dictionary","version":"3.3.0-20210722-143810"},{"name":"Dictionary","version":"3.3.0-20210722-143810"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"File","version":"5.0.0-20210727-180900"},{"name":"File","version":"5.0.0-20210727-180900"},{"name":"GoogleDocumentAI","version":"1.0.2-20210521-092843"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"JSONParser","version":"2.0.10-20210907-084932"},{"name":"JSONParser","version":"2.0.10-20210907-084932"},{"name":"List","version":"2.4.0-20210722-144333"},{"name":"List","version":"2.4.0-20210722-144333"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"Loop","version":"3.0.0-20210722-144335"},{"name":"Loop","version":"3.0.0-20210722-144335"},{"name":"Process","version":"4.0.0-20210806-052725"},{"name":"Process","version":"4.0.0-20210806-052725"},{"name":"Step","version":"2.0.2-20210716-100543"},{"name":"Step","version":"2.0.2-20210716-100543"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"String","version":"4.3.0-20210722-144812"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}