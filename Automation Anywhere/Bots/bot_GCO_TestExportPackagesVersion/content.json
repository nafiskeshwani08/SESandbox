{"triggers":[],"nodes":[{"uid":"3cb7b274-2730-4400-a908-0be2ef683aa8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b4537254-6d35-406b-ad35-7c0c94a51d10","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------"}}]},{"uid":"f476dedf-b6fd-4c00-a99b-f0cef25fe0ce","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This bot will get all versions of the packages used in a process (Main+subtask) and list them in xls file"}}]},{"uid":"2f7b7df1-efd8-46c5-ad8e-9908db64a51b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Bot Description"}}]},{"uid":"9085de16-a9f3-4d88-b76a-22e22b36fdb4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"dcf20c3c-ae96-46a9-930c-00a94666b54a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get all dependencies of a main task (need id of main task)"}}]},{"uid":"c442dcd5-e08c-4249-8af5-29fb6552cc7d","commandName":"StartSession","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"string":"Default","type":"STRING"}}]},{"uid":"61b07658-359a-4a51-bc0a-4463453d3cbc","commandName":"GetBots","packageName":"RepositoryServices","disabled":true,"attributes":[{"name":"sessionName","value":{"string":"Default","type":"STRING"}},{"name":"workspacetype","value":{"string":"SELECT","type":"STRING"}},{"name":"workspaceSelect","value":{"string":"public","type":"STRING"}}]},{"uid":"87aac02a-b329-4938-852f-9fd492cc30b9","commandName":"GetDependencies","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"id","value":{"type":"STRING","string":"11649"}}],"returnTo":{"type":"VARIABLE","variableName":"lDependencies"}},{"uid":"d14a31f4-ddf8-4315-a069-963177bd491d","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"dependencies: $lDependencies.LegacyAutomation:listToString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a51e74cb-7535-4938-8d1a-12dfac681881","commandName":"GetBotAgentToken","packageName":"A2019_Control_Room_APIs","disabled":false,"returnTo":{"type":"VARIABLE","variableName":"sToken"}},{"uid":"2af2fb7a-7833-4dc8-9363-1a9e5e1b8aed","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Open xls file (change path if needed)"}}]},{"uid":"74a647b9-91c5-4f4d-9387-a4a5f1a1b85b","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Test/PackageList.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"session1"},"sessionTarget":"LOCAL"}},{"uid":"d85cb483-3c54-4f8f-9f79-36668febac9d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Loop in all tasks (main+dependencies)"}}]},{"uid":"ec9e6d5b-84a6-4f64-8ac6-a2cd29531f3b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4cccc79b-0886-408b-95bb-79b3a63f894e","commandName":"Initialize","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonString","value":{"type":"STRING","expression":"$dDependencyJson$"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"d44e47d5-c8c6-4c70-8cd3-3aee752ddc8d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task name"}}]},{"uid":"e43acf9a-2a2e-4105-9896-037d2b6bc660","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"name"}}],"returnTo":{"type":"VARIABLE","variableName":"depName"}},{"uid":"fe225588-3aab-46cb-9df7-c2e9ca4d70d4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task id"}}]},{"uid":"c4c6db40-aa20-4f4b-b9c9-13a4fd226352","commandName":"Query","packageName":"JSONHandler","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jsonQuery","value":{"type":"STRING","string":"id"}}],"returnTo":{"type":"VARIABLE","variableName":"depId"}},{"uid":"451c5465-38bb-4ef9-b67a-4d43fc0b4d21","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get task details"}}]},{"uid":"5b02202d-8559-43fc-82b9-4413f76520f7","commandName":"GetFileDetails","packageName":"RepositoryServices","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"id","value":{"type":"STRING","expression":"$depId$"}},{"name":"workspacetype","value":{"type":"STRING","string":"SELECT"}},{"name":"workspaceSelect","value":{"type":"STRING","string":"public"}}],"returnTo":{"type":"VARIABLE","variableName":"dBotDetails"}},{"uid":"f3d79c70-6e4e-4dbe-a37a-c992db82b150","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dBotDetails{type}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a7c1459e-ed0d-434c-ad77-b11b77c0da4b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"filter on taskbots only from dependencies (could be images, other files...)"}}]},{"uid":"cf27541f-38f5-4cc0-b107-695501699cb1","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"81b863d3-2914-44c8-9e26-de308249dea0","commandName":"toNumber","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$depId$"}}],"returnTo":{"type":"VARIABLE","variableName":"nBotId"}},{"uid":"d2d6b19c-d95d-430c-8a19-427e96a99a97","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$depId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"0eeeca4a-a678-4f1a-b28b-08eef75f4b2b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get packages list (name and version) for current task"}}]},{"uid":"dbe1c949-4164-4c0a-a193-90dbbbb967b5","commandName":"GetBotPackages","packageName":"A2019_Control_Room_APIs","disabled":false,"attributes":[{"name":"sessionTypeInput","value":{"type":"STRING","string":"BOT_RUNNER_SESSION"}},{"name":"fileIdInput","value":{"type":"NUMBER","expression":"$nBotId$"}}],"returnTo":{"type":"VARIABLE","variableName":"lPackagesList"}},{"uid":"828acf99-29eb-40c9-8bc7-c088f17b9966","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Write in xls file"}}]},{"uid":"3aa6ada6-d6b3-4440-bb0e-9e78cbf47d87","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"26cc273b-64ce-420f-8b09-a7229a613269","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"A$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$depId$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"session1"}}}]},{"uid":"1ff00fe0-be39-4e1e-8d67-62153476fbbf","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"B$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$depName$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"session1"}}}]},{"uid":"06575820-47bb-471f-b76c-ea065c43c5de","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$Counter.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$dCurrentPackage$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"session1"}}}]},{"uid":"e6377d93-baa4-47af-b0de-ebad9060abe9","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$Counter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"Counter"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dCurrentPackage"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lPackagesList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"fd7694bb-3024-40c3-9e6d-79f30bcbb9a1","commandName":"put","packageName":"Dictionary","disabled":true,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dBotPackages"}},{"name":"key","value":{"type":"STRING","string":"id"}},{"name":"varOrManual","value":{"type":"STRING","string":"Variable"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"depId"}}]},{"uid":"b96b8d23-3b2b-4c19-afae-84cb34145cd7","commandName":"put","packageName":"Dictionary","disabled":true,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dBotPackages"}},{"name":"key","value":{"type":"STRING","string":"name"}},{"name":"varOrManual","value":{"type":"STRING","string":"Variable"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"depName"}}]},{"uid":"faf66a61-0d50-47e6-90c9-eb3f924fcc37","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lDendanciesIDs"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"depId"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"4ccc4bbd-1368-4aee-bed1-13afeacf6a8e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"dependencies ID: $depId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dBotDetails{type}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"application/vnd.aa.taskbot"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dDependencyJson"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lDependencies"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get all bot id"}}]},{"uid":"9d982157-0685-41a2-ab8b-ab765a6e9227","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"46eec7e1-018d-45dd-a81a-e6be316eac55","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get all dependencies of a main task (need id of main task)"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get Other CR packages versions (PROD for example)"}}]},{"uid":"96f4dd44-8f38-4500-ae02-37b597b4a6a5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"64df1cef-1cef-4581-8533-0c10ba35f475","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Todo"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Export all missing packages"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sToken","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"lPackagesList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"dFileList","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sOutput","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dJsonOutput","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dBotsList","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"dCurrentBotId","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"tPackageList","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"lAllPackages","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"LIST","list":[]}},{"name":"dCurrentPackage","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"Counter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"2"}},{"name":"dAllPackages","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"lDependencies","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"DICTIONARY","defaultValue":{"type":"LIST","list":[]}},{"name":"dDependencyJson","description":"","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"depId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"lDendanciesIDs","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"LIST","list":[]}},{"name":"depName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"dBotPackages","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"nBotId","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dBotDetails","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"lPackagesCR","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"sCurrentCRPackage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nSize","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nIndex","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":["87aac02a-b329-4938-852f-9fd492cc30b9","dbe1c949-4164-4c0a-a193-90dbbbb967b5"],"packages":[{"name":"A2019_Control_Room_APIs","version":"1.24.1-20211206-090004"},{"name":"Comment","version":"2.10.0-20220118-153626"},{"name":"Dictionary","version":"3.4.0-20211011-141701"},{"name":"Dictionary","version":"3.4.0-20211011-141701"},{"name":"Excel_MS","version":"6.3.0-20211028-055115"},{"name":"Excel_MS","version":"6.3.0-20211028-055115"},{"name":"If","version":"3.4.0-20220127-062702"},{"name":"JSONHandler","version":"1.0.9-20200423-090902"},{"name":"LegacyAutomation","version":"4.7.0-20211020-020823"},{"name":"LegacyAutomation","version":"4.7.0-20211020-020823"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"Loop","version":"3.1.0-20211011-141812"},{"name":"Loop","version":"3.1.0-20211011-141812"},{"name":"MessageBox","version":"3.1.0-20211011-141813"},{"name":"MessageBox","version":"3.1.0-20211011-141813"},{"name":"Number","version":"3.2.0-20211011-141826"},{"name":"Number","version":"3.2.0-20211011-141826"},{"name":"RepositoryServices","version":"2.1.0-20211217-173811"},{"name":"Step","version":"2.1.0-20211016-070304"},{"name":"Step","version":"2.1.0-20211016-070304"},{"name":"String","version":"5.0.0-20211011-142159"},{"name":"String","version":"5.0.0-20211011-142159"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}